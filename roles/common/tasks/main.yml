---
# RedHat-like
- name: copy zabbix repo
  template: src=zabbix.repo.j2 dest=/etc/yum.repos.d/zabbix.repo
  when: ansible_os_family == "RedHat"

- name: copy nginx repo
  template: src=nginx.repo.j2 dest=/etc/yum.repos.d/nginx.repo
  when: server_frontend is defined and ansible_os_family == "RedHat"

- name: copy pgsql repo
  template: src=pgdg-centos.repo.j2 dest=/etc/yum.repos.d/pgdg-centos.repo
  when: pgsql_version is defined and ansible_os_family == "RedHat"

# Ubuntu14 (just agent)
- name: get Ubuntu14 repo
  get_url: url=http://repo.zabbix.com/zabbix/2.4/ubuntu/pool/main/z/zabbix/zabbix-agent_2.4.5-1+trusty_amd64.deb dest=/usr/src/zabbix-agent_2.4.5-1+trusty_amd64.deb
  when: ansible_distribution == "Ubuntu" and ansible_distribution_major_version == "14"

- name: intall Ubuntu14 repo
  apt: deb=/usr/src/zabbix-agent_2.4.5-1+trusty_amd64.deb 
  when: ansible_distribution == "Ubuntu" and ansible_distribution_major_version == "14"

# Ubuntu12 (just agent)
- name: get Ubuntu12 repo
  get_url: url=http://repo.zabbix.com/zabbix/2.4/ubuntu/pool/main/z/zabbix/zabbix-agent_2.4.5-1+precise.deb dest=/usr/src/zabbix-agent_2.4.5-1+precise.deb
  when: ansible_distribution == "Ubuntu" and ansible_distribution_major_version == "12"

- name: intall Ubuntu12 repo
  apt: deb=/usr/src/zabbix-agent_2.4.5-1+precise.deb 
  when: ansible_distribution == "Ubuntu" and ansible_distribution_major_version == "12"
